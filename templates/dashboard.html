{% extends "base.html" %}

{% block content %}
<!-- HoÅŸ Geldin -->
<div class="welcome-section">
    <h1 class="welcome-title">Merhaba, {{ username }} ğŸ‘‹</h1>
    <p class="welcome-subtitle">LoroLeng ile her gÃ¼n biraz daha iyi ol!</p>
</div>

<!-- HÄ±zlÄ± Ä°statistikler -->
<div class="row mb-4 g-3">
    <div class="col-md-3 col-6">
        <div class="stat-card stat-streak">
            <div class="stat-icon">ğŸ”¥</div>
            <div class="stat-value" id="streakCount">0</div>
            <div class="stat-label">GÃ¼nlÃ¼k Seri</div>
        </div>
    </div>
    <div class="col-md-3 col-6">
        <div class="stat-card stat-correct">
            <div class="stat-icon">âœ…</div>
            <div class="stat-value" id="todayCorrect">0</div>
            <div class="stat-label">BugÃ¼n DoÄŸru</div>
        </div>
    </div>
    <div class="col-md-3 col-6">
        <div class="stat-card stat-words">
            <div class="stat-icon">ğŸ“š</div>
            <div class="stat-value" id="wordsLearned">0</div>
            <div class="stat-label">Ã–ÄŸrenilen Kelime</div>
        </div>
    </div>
    <div class="col-md-3 col-6">
        <div class="stat-card stat-rank">
            <div class="stat-icon">ğŸ†</div>
            <div class="stat-value" id="userRank">-</div>
            <div class="stat-label">SÄ±ralama</div>
        </div>
    </div>
</div>

<!-- Pratik KartlarÄ± -->
<div class="section-header">
    <i class="bi bi-lightning-charge-fill"></i>
    <h2 class="section-title">HÄ±zlÄ± Pratik</h2>
</div>
<div class="row mb-4 g-4">
    <div class="col-md-4">
        <div class="practice-card practice-word">
            <div class="practice-icon">ğŸ“–</div>
            <h3 class="practice-title">Kelime Ã‡alÄ±ÅŸ</h3>
            <p class="practice-desc">Ä°ngilizce kelimeleri TÃ¼rkÃ§e'ye Ã§evir ve kelime hazineni geniÅŸlet.</p>
            <a href="{{ url_for('practice_word') }}" class="btn btn-modern btn-modern-secondary">
                <i class="bi bi-play-fill"></i> BaÅŸla
            </a>
        </div>
    </div>
    <div class="col-md-4">
        <div class="practice-card practice-sentence">
            <div class="practice-icon">âœï¸</div>
            <h3 class="practice-title">CÃ¼mle & Gramer</h3>
            <p class="practice-desc">Ä°ngilizce cÃ¼mleler yaz, gramer hatalarÄ±nÄ± Ã¶ÄŸren.</p>
            <a href="{{ url_for('practice_sentence') }}" class="btn btn-modern btn-modern-primary">
                <i class="bi bi-play-fill"></i> BaÅŸla
            </a>
        </div>
    </div>
    <div class="col-md-4">
        <div class="practice-card practice-pronunciation">
            <div class="practice-icon">ğŸ¤</div>
            <h3 class="practice-title">Telaffuz PratiÄŸi</h3>
            <p class="practice-desc">Kelimeleri sesli sÃ¶yle, telaffuzunu geliÅŸtir.</p>
            <a href="{{ url_for('pronunciation') }}" class="btn btn-modern btn-modern-danger">
                <i class="bi bi-play-fill"></i> BaÅŸla
            </a>
        </div>
    </div>
</div>

<!-- Alt BÃ¶lÃ¼m: Hedefler ve Sosyal -->
<div class="row g-4">
    <!-- Aktif Hedefler -->
    <div class="col-lg-6">
        <div class="goals-card">
            <div class="goals-card-header">
                <i class="bi bi-bullseye"></i>
                <h5>Aktif Hedefler</h5>
            </div>
            <div class="goals-card-body" id="activeGoals">
                {% if active_goals and active_goals|length > 0 %}
                    {% for goal in active_goals[:3] %}
                    <div class="goal-item">
                        <div class="goal-header">
                            <span class="goal-title">{{ goal.title }}</span>
                            <span class="goal-badge {% if goal.days_remaining < 3 %}bg-danger text-white{% elif goal.days_remaining < 7 %}bg-warning{% else %}bg-secondary text-white{% endif %}">
                                {{ goal.days_remaining }} gÃ¼n
                            </span>
                        </div>
                        <div class="progress-modern">
                            <div class="progress-bar" style="width: {{ goal.progress_percent }}%;"></div>
                        </div>
                        <div class="goal-progress-text">{{ goal.current_progress|round(1) }} / {{ goal.target_value }}</div>
                    </div>
                    {% endfor %}
                    {% if active_goals|length > 3 %}
                    <p class="text-muted small mt-2">+{{ active_goals|length - 3 }} hedef daha...</p>
                    {% endif %}
                {% else %}
                <div class="text-center py-4">
                    <div style="font-size: 48px; margin-bottom: 12px;">ğŸ¯</div>
                    <p class="text-muted mb-3">HenÃ¼z hedef belirlemediniz.</p>
                    <a href="{{ url_for('goals') }}" class="btn btn-modern btn-modern-primary btn-sm">
                        <i class="bi bi-plus"></i> Hedef OluÅŸtur
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="goals-card-footer">
                <a href="{{ url_for('goals') }}" class="text-decoration-none" style="color: var(--primary); font-weight: 600;">
                    TÃ¼m hedefleri gÃ¶r <i class="bi bi-arrow-right"></i>
                </a>
            </div>
        </div>
    </div>
    
    <!-- HÄ±zlÄ± Linkler -->
    <div class="col-lg-6">
        <div class="goals-card">
            <div class="goals-card-header">
                <i class="bi bi-grid-fill" style="color: var(--secondary);"></i>
                <h5>HÄ±zlÄ± EriÅŸim</h5>
            </div>
            <div class="goals-card-body">
                <div class="row g-3">
                    <div class="col-6">
                        <a href="{{ url_for('user_stats') }}" class="quick-link">
                            <i class="bi bi-bar-chart-fill"></i>
                            Ä°statistikler
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ url_for('leaderboard') }}" class="quick-link">
                            <i class="bi bi-trophy-fill" style="color: var(--accent);"></i>
                            SÄ±ralama
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ url_for('personal_feedback') }}" class="quick-link">
                            <i class="bi bi-robot" style="color: #a855f7;"></i>
                            AI Geri Bildirim
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ url_for('custom_lesson') }}" class="quick-link">
                            <i class="bi bi-magic" style="color: var(--primary);"></i>
                            Ã–zel Ders
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ url_for('friends') }}" class="quick-link">
                            <i class="bi bi-people-fill" style="color: var(--secondary);"></i>
                            ArkadaÅŸlar
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ url_for('notifications') }}" class="quick-link">
                            <i class="bi bi-bell-fill" style="color: var(--danger);"></i>
                            Bildirimler
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Dashboard istatistiklerini yÃ¼kle
document.addEventListener('DOMContentLoaded', function() {
    fetch('/api/dashboard-stats')
        .then(response => response.json())
        .then(data => {
            if (data.streak !== undefined && data.streak !== null)
                document.getElementById('streakCount').textContent = data.streak;
            if (data.today_correct !== undefined && data.today_correct !== null)
                document.getElementById('todayCorrect').textContent = data.today_correct;
            if (data.words_learned !== undefined && data.words_learned !== null)
                document.getElementById('wordsLearned').textContent = data.words_learned;
            if (data.rank !== undefined && data.rank !== null)
                document.getElementById('userRank').textContent = '#' + data.rank;
        })
        .catch(err => console.log('Ä°statistik yÃ¼kleme hatasÄ±:', err));
});
</script>
{% endblock %}

